import numpy as np
import matplotlib.pyplot as plt

X = np.array([ [ 0.540500000000000,   0.241600000000000,  -0.030900000000000,   0.230500000000000,  -0.348100000000000,  -0.353900000000000,  -0.575900000000000,   0.901000000000000,   1.000000000000000,   0.623500000000000,   0.222500000000000,   0.901000000000000,  -0.222500000000000,   0.623500000000000,   0.222500000000000,  -0.623500000000000,  -0.222500000000000,  -0.901000000000000,  -1.000000000000000,  -0.623500000000000,  -0.901000000000000], \
               [ -0.363636363636364,   0.929272727272727,   0.363636363636364,  -0.938909090909091,   0.767454545454545,  -0.840727272727273,  -0.363636363636364,   0.433900000000000,                   0,   0.781800000000000,   0.974900000000000,  -0.433900000000000,   0.974900000000000,  -0.781800000000000,  -0.974900000000000,   0.781800000000000,  -0.974900000000000,   0.433900000000000,                   0,  -0.781800000000000,  -0.433900000000000]])
X = X.T
T = np.asarray([[9, 14, 13, 18, 17,  8, 15,  7, 16, 10, 20, 19, 12, 11, 19, 4,  6,  9,  5,  4,  5,  0,  2,  4,  11,  1], \
              [ 10, 13, 11, 20, 18,  7, 17,  1, 14, 12,  5, 16, 15,  8,  5, 17,  5,  1, 16,  6,  3,  1,  3,  2,   0, 12],\
              [1,  3,  3,  6,  6,  0,  4,  0,  3,  1,  6,  5,  4,  0, 20,  6,  2,  7,  3,  2,  2,  2,  0,  1,   3,  4]])
T = T.T
Nint = 7

def plotMesh(X,title):
    fig1, ax1 = plt.subplots()
    ax1.set_aspect('equal')
    ax1.triplot(X[:,0], X[:,1], T, 'k*-', lw=1.0)
    ax1.plot(X[:Nint,0], X[:Nint,1], 'ro')
    ax1.set_title(title)#'Malla inicial')
    plt.show()

def dofsToCoords(y):
    return np.block([[np.reshape(y, (Nint, 2),order='F')],[X[Nint:,:]]])

def coordsToDofs(X):
    return np.reshape(X[:Nint,:], 2*Nint,order = 'F')